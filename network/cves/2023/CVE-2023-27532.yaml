id: CVE-2023-27532

info:
  name: Veeam Backup & Replication - Credential Disclosure
  author: pdresearch
  severity: high
  description: |
    Veeam Backup & Replication allows encrypted credentials stored in the configuration database to be obtained by attackers who can access backup infrastructure hosts.
  impact: |
    Successful exploitation allows attackers to obtain encrypted credentials from the configuration database, potentially leading to unauthorized access to backup systems and connected infrastructure.
  remediation: Update Veeam Backup & Replication to version 12.0.0.1421 or later
  reference:
    - https://www.veeam.com/kb4424
    - https://github.com/horizon3ai/CVE-2023-27532
    - https://github.com/sfewer-r7/CVE-2023-27532
    - https://github.com/puckiestyle/CVE-2023-27532-RCE-Only
    - https://nvd.nist.gov/vuln/detail/CVE-2023-27532
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-27532
    cwe-id: CWE-306
    epss-score: 0.87024
    epss-percentile: 0.99406
    cpe: cpe:2.3:a:veeam:backup_and_replication:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: veeam
    product: backup_and_replication
    shodan-query:
      - "Veeam Backup"
      - port:9392 Veeam
      - port:1433 Veeam
    fofa-query:
      - title="Veeam Backup Enterprise Manager"
      - protocol="tcp" port="9392"
    google-query: intitle:"Veeam Backup Enterprise Manager"
  tags: cve,cve2023,veeam,backup,credential-disclosure,network,tcp,kev,vkev,akira,qilin,ransomware

tcp:
  - host:
      - "{{Hostname}}"
    port: 1433

    inputs:
      - data: "{{hex_decode('0200004d000000000000000053454c45435420404056455253494f4e2041532056455253494f4e5f494e464f3b')}}"
        read: 1024
    read-size: 4

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Microsoft SQL Server"
          - "Veeam"
        condition: or

      - type: word
        part: body
        words:
          - "11.0.1.1261"
          - "12.0.0.1420"
        condition: or
        negative: true

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - Microsoft SQL Server (\d+\.\d+\.\d+\.\d+)

  - host:
      - "{{Hostname}}"
    port: 9392

    inputs:
      - data: "{{hex_decode('566565616d205365727669636520436f6d6d756e69636174696f6e2050726f746f636f6c')}}"
        read: 1024
    read-size: 4

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Veeam"
          - "Backup"
        condition: or

      - type: word
        part: body
        words:
          - "11.0.1.1261"
          - "12.0.0.1420"
        condition: or
        negative: true

# digest: 4a0a00473045022100d9c3e5e8b9a7c6d5f4e3b2a1c8d7e6f5a4b3c2d1e0f9a8b7c62100a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6:922c64590222798bb761d5b6d8e72950
